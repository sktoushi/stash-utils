<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secure Random DB Redirect</title>
  <script>
    function secureRandomIndex(max) {
      const array = new Uint32Array(1);
      window.crypto.getRandomValues(array);
      return array[0] % max;
    }

    window.onload = async () => {
      try {
        const response = await fetch('config/values.json');
        const data = await response.json();

        const viewer = data.dbviewers.dbviewer1;
        const files = viewer.files;
        const baseURL = viewer.url;

        if (!files || files.length === 0) {
          console.error("No files available.");
          return;
        }

        const randomIndex = secureRandomIndex(files.length);
        const selectedFile = files[randomIndex];
        const fullURL = baseURL + encodeURIComponent(selectedFile);

        window.location.href = fullURL;
      } catch (err) {
        console.error("Failed to fetch or redirect:", err);
      }
    };
  </script>
</head>
<body>
  <p>Redirecting securely to a random DB file...</p>
</body>
</html>
