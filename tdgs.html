<!doctype html><html><head><meta charset="utf-8">
<title>Private Drive PDF</title>
<style>html,body,iframe{margin:0;height:100%;width:100%;border:0}</style>
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js" async defer></script>
</head><body>

<iframe id="pdf"></iframe>

<script>
  const CLIENT_ID = '569755047834-3mn8irblfmqa8puatv1iapdaj1ug86s3.apps.googleusercontent.com';
  const FILE_ID   = '1w5-ntNxYHeZ8tcxN3nyOjshaS7YRQypc';
  const PAGE      = 21 ;                         // starting page

  // 1) one-tap sign-in
  google.accounts.id.initialize({
    client_id: CLIENT_ID,
    callback  : tokenResponse => start(tokenResponse.credential)
  });
  google.accounts.id.prompt();                // shows the Google picker

  async function start(idToken) {
    // 2) set up gapi client with Drive scope
    await new Promise(r => gapi.load('client', r));
    await gapi.client.init({
      apiKey     : '',                        // not needed for OAuth flow
      clientId   : CLIENT_ID,
      scope      : 'https://www.googleapis.com/auth/drive.readonly'
    });
    gapi.client.setToken({access_token: idToken});

    // 3) download the file (alt=media) as ArrayBuffer
    const resp = await gapi.client.request({
      path : `/drive/v3/files/${FILE_ID}`,
      method: 'GET',
      params: {alt: 'media'},
      responseType: 'arraybuffer'
    });

    const blob = new Blob([resp.body], {type:'application/pdf'});
    document.getElementById('pdf').src =
      `${URL.createObjectURL(blob)}#page=${PAGE}`;
  }
</script>
</body></html>
